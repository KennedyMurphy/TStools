}
f.season <- ts(f.season,start=s,frequency=m)
}
decomp(referrals,type="pure.seasonal",h=10)
library(TStools)
decomp(referrals,type="pure.seasonal",h=10)
decomp(referrals,type="pure.seasonal",h=10)
library(TStools)
library(TStools)
decomp(referrals,type="pure.seasonal",h=10)
library(TStools)
decomp(referrals,type="pure.seasonal",h=10)
library(TStools)
decomp(referrals,type="pure.seasonal",h=10)
library(TStools)
decomp(referrals,type="pure.seasonal",h=10)
decomp(referrals,type="pure.seasonal",h=10)
library(TStools)
decomp(referrals,type="pure.seasonal",h=10,outplot=TRUE)
library(TStools)
library(TStools)
class(y)[1]
library(TStools)
install.packages(c("forecast", "R.utils", "RcppArmadillo"))
install.packages("neuralnet")
idclass(data,outplot="summary",type="PKa",plot.focus=c(1.6,1.2))
source("idclass.R")
y <- readClipboard()
y <- as.numeric(y)
y <- ts(y,frequency=12)
plot(y)
theta(y)
library(TStools)
ets(y)
theta(y)
y.in <- y[1:20]
plot(y.in)
plot(y.in,type="l")
theta(y.in)
y.in <- ts(y.in,frequency=12)
plot(y.in)
theta(y.in)
(n %% m)
(n %% m)
n
n
m
library(TStools)
theta(y.in)
y <- y.in
m=NULL
h=10
outplot=0
sign.level=0.05
cost0=c("MSE","MdSE","MAE","MdAE")
cost2=c("MSE","MdSE","MAE","MdAE")
costs=c("MSE","MdSE","MAE","MdAE")
multiplicative=c(TRUE,FALSE)
cma=NULL
cost0 <- cost0[1]
cost2 <- cost2[1]
costs <- costs[1]
multiplicative <- multiplicative[1]
n <- length(y)
if (is.null(m)){
if (class(y) == "ts"){
m <- frequency(y)
} else {
stop("Seasonality not defined (y not ts object).")
}
}
if (!is.null(cma)){
if (n != length(cma)){
stop("Length of series and cma do not match.")
}
} else {
# Calculate CMA
cma <- cmav(y,ma=m,outplot=0,fast=TRUE)
}
trend.exist <- coxstuart(cma)$p.value <= sign.level/2
k <- m - (n %% m)
k
m
n
m
m - (n %% m)
ynt
lenght(n)
length(n)
length(y)
length(y)/m
library(TStools)
theta(y)
theta(y,h=12,outplot=1)
theta(y,h=12,outplot=1)
theta(y,h=12,outplot=2)
theta(y)
seasplot(y)
library(TStools)
seasplot(y)
decomp(y)
decomp(y,ouplot=1)
decomp(y,outplot=1)
load('cnc.data.Rdata')
data <- t(cnc.data)
n.series <- ncol(data)
# Check time series length, remove series with zero length
data <- t(cnc.data)
getwd()
load('../../CnC/cnc.data.Rdata')
data <- t(cnc.data)
n.series <- ncol(data)
data <- t(cnc.data)
data <- data
n <- ncol(data)
n <- ncol(data)
data.length <- vector("numeric",n)
for (i in 1:n){
data.length[i] <- sum(data[,i]>0)
}
data.length
t <- 5
data.length >= n
data.length >= t
plot(1:n,sort(data.length),col="blue")
plot(1:n,sort(data.length),col="blue",type="l")
polygon(c(1:n,n,1),c(sort(data.length),max(data.length),min(data.length)))
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)))
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)))
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue")
lines(1:n,c(t,t),col="red")
lines(c(1,n),c(t,t),col="red")
lines(c(1,n),c(t,t),col="red",lwd=2)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
lines(c(1,n),c(t,t),col="red",lwd=2)
plot(NA,NA)
plot(0,0)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
lines(c(1,n),c(t,t),col="red",lwd=2)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
lines(c(1,n),c(t,t),col="red",lwd=2)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
lines(c(1,n),c(t,t),col="red",lwd=2)
plot.new(xlim=c(1,n))
plot.new()
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
lines(c(1,n),c(t,t),col="red",lwd=2)
plot(c(1,n),c(t,t),col="red",lwd=2)
plot(c(1,n),c(t,t),type="l",col="red",lwd=2)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
lines(c(1,n),c(t,t),col="red",lwd=2)
plot(1:n,sort(data.length),type="l",col="black",lwd=2)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
lines(c(1,n),c(t,t),col="red",lwd=2)
plot(1:n,sort(data.length),type="l",col="black",lwd=1)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
plot(1:n,sort(data.length),type="l",col="black",lwd=3)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
plot(1:n,sort(data.length),type="l",col="black",lwd=0)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border=NA)
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border="black")
plot(1:n,sort(data.length),type="l",col="black",lwd=0,xaxs="i",yaxs="i")
polygon(c(1:n,n,1),c(sort(data.length),min(data.length),min(data.length)),col="blue",border="black")
lines(c(1,n),c(t,t),col="red",lwd=2)
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.u
sl.a <- sl[sl>=t]
sl.a
1:length(sl.u)
polygon(c(1:length(sl.u),n,1),c(sl.u,min(sl.u)*c(1,1)),col="blue",border="black")
polygon(c(1:length(sl.u),length(sl.u),n,1),c(sl.u,min(sl.a),min(sl.u)*c(1,1)),col="blue",border="black")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="blue",border="black")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="red",border="black")
polygon(c(length(sl.u):n,n,1),c(sl.a,min(sl.a)*c(1,1)),col="blue",border="black")
c(sl.a,min(sl.a)*c(1,1))
polygon(c((length(sl.u)+1):n,n,1),c(sl.a,min(sl.a)*c(1,1)),col="blue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=2)
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="red",border="black")
polygon(c((length(sl.u)+1):n,n,1),c(sl.a,min(sl.a)*c(1,1)),col="blue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1)
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="red",border="black")
polygon(c((length(sl.u)+1):n,n,1),c(sl.a,min(sl.a)*c(1,1)),col="blue",border="black")
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="red",border="black")
polygon(c((length(sl.u)+1):n,n,1),c(sl.a,min(sl.a)*c(1,1)),col="blue",border="black")
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="red",border="black")
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="blue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1)
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="lightblue",border="black")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="lightred",border="black")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
round(100*sum(!idx)/n)
idx <- data.length >= t
round(100*sum(!idx)/n,2)
text(n,0,paste0(round(100*sum(!idx)/n,2),'%')
)
paste0(round(100*sum(!idx)/n,2),'%')
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),pos=1)
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),pos=2)
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),pos=3)
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),pos=4)
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),pos=3)
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),adj=c(0.1,0.1))
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),adj=c(-0.1,-0.1))
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1)
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),adj=c(-0.1,-0.1))
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),adj=c(-1,-1))
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'),adj=c(1,1))
text(n,0,paste0(round(100*sum(!idx)/n,2),'%'))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=1,line=2,at=c(5,7))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=3,line=2,at=c(5,7))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=2,at=c(5,7))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=2,line=2,at=c(5,7))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=2,line=2,at=c(t/2,((max(sl)-t))/2+t)
((max(sl)-t))/2+t
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=2,line=2,at=c(t/2,((max(sl)-t)/2+t)))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=2,line=2,at=c(t/2,((max(sl)-t)/2+t)))
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
# Plot profile
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1)
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=2,line=2,at=c(t/2,((max(sl)-t)/2+t)))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=1,at=c(t/2,((max(sl)-t)/2+t)))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.5,at=c(t/2,((max(sl)-t)/2+t)))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.3,at=c(t/2,((max(sl)-t)/2+t)))
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1)
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
text(1,t,'Threshold')
text(1,t,'Threshold',adj=c(1,1))
text(1,t,'Threshold',adj=c(1,0.3))
text(1,t,'Threshold')
text(1,t,'Threshold',pos=1)
text(1,t,'Threshold',pos=2)
text(1,t,'Threshold',pos=3)
text(1,t,'Threshold',pos=3,offset=0.5)
text(1,t,'Threshold',pos=3,offset=5)
text(1,t,'Threshold',pos=3,offset=-0.5)
text(1,t,'Threshold',pos=3)
text(1,t,'Threshold',offset=1)
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1)
text(1,t,'Threshold',offset=1)
text(1,t,'Threshold',offset=2)
text(1,t,'Threshold',offset=20)
text(1,t,'Threshold',offset=-20)
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1,lty=2)
lines(c(1,n),c(t,t),col="red",lwd=1,lty=2)
lines(c(1,n),c(t,t),col="red",lwd=1,lty=1)
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
t <- 0
outplot <- TRUE
n <- ncol(data)
data.length <- vector("numeric",n)
for (i in 1:n){
data.length[i] <- sum(data[,i]>0)
}
# Find series under the threshold
idx <- data.length >= t
if (outplot == TRUE){
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
# Plot profile
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
}
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
sl.u
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
polygon(c(1:n,n,n,1),c(sl,min(sl)*c(1,1),1),col="deepskyblue",border="black")
polygon(c(1:n,n,n,1),c(sl,min(sl),c(1,1)),col="deepskyblue",border="black")
polygon(c(1:n,n,1),c(sl,c(1,1)),col="deepskyblue",border="black")
polygon(c(1:n,n,1),c(sl,0,0),col="deepskyblue",border="black")
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
polygon(c(1:n,n,1),c(sl,0,0),col="deepskyblue",border="black")
if (outplot == TRUE){
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
# Plot profile
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
if (length(sl.u)>0){
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
} else {
polygon(c(1:n,n,1),c(sl,0,0),col="deepskyblue",border="black")
}
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
}
t <- 1
if (outplot == TRUE){
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
# Plot profile
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
if (length(sl.u)>0){
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
} else {
polygon(c(1:n,n,1),c(sl,0,0),col="deepskyblue",border="black")
}
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
}
t
sl[sl<t]
sl
sl.u <- sl[sl<t]
sl.u
idx
!idx
sum(!idx)
idx
t
data.length
data.length >= t
idx <- data.length >= t
idx
if (outplot == TRUE){
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
# Plot profile
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
if (length(sl.u)>0){
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
} else {
polygon(c(1:n,n,1),c(sl,0,0),col="deepskyblue",border="black")
}
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
}
t=NULL
data.length >= t
!is.null(t)
idx <- vector(TRUE,n)
idx <- rep(TRUE,n)
idx
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
sl.u
sl.a
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
if (outplot == TRUE){
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
# Plot profile
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length")
if (length(sl.u)>0){
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
} else {
polygon(c(1:n,n,1),c(sl,0,0),col="deepskyblue",border="black")
}
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
}
y[,i]>0
x <- abs(matrix(cumsum(rnorm(5400,0,1)),36,150))
View(x)
x[1:20,1:50] <- 0
library(TStools)
x <- abs(matrix(cumsum(rnorm(5400,0,1)),36,150))
x[1:20,1:50] <- 0
nzlength(x,30,outplot=TRUE)
library(TStools)
x <- abs(matrix(cumsum(rnorm(5400,0,1)),36,150))
x[1:20,1:50] <- 0
nzlength(x,30,outplot=TRUE)
y <- x
t <- 30
n <- ncol(y)
data.length <- vector("numeric",n)
for (i in 1:n){
data.length[i] <- sum(y[,i]>0)
}
if (!is.null(t)){
idx <- data.length >= t
} else {
idx <- rep(TRUE,n)
}
idx
sl <- sort(data.length)
sl.u <- sl[sl<t]
sl.a <- sl[sl>=t]
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length",ylim=c(0,max(sl)))
length(sl.u)
sl
t
sl.u <- sl[sl<t]
sl.u
sl.a
sl.u
length(sl.u)
(length(sl.u)>0)
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),min(sl.u)*c(1,1)),col="grey",border="black")
sl.u
1:length(sl.u)
length(sl.u)
c(1:length(sl.u),length(sl.u),n,n,1)
sl.u
min(sl.a)*c(1,1)
sl.u
min(sl.a)*c(1,1)
min(sl.u)*c(1,1)
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),0,0),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,min(sl.a)*c(1,1)),col="deepskyblue",border="black")
c((length(sl.u)+1):n,n,(length(sl.u)+1))
sl.a
min(sl.a)*c(1,1)
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,max(sl.u)*c(1,1)),col="deepskyblue",border="black")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),0,0),col="grey",border="black")
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),0,0),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,max(sl.u)*c(1,1)),col="deepskyblue",border="black")
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(t/2,((max(sl)-t)/2+t)))
t
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(max(sl.u)/2,((max(sl)-max(sl.u))/2+max(sl.u))))
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),0,0),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,max(sl.u)*c(1,1)),col="deepskyblue",border="black")
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(max(sl.u)/2,((max(sl)-max(sl.u))/2+max(sl.u))))
# Plot profile
plot(1:n,sl,type="l",col="black",lwd=0,xaxs="i",yaxs="i",xlab="Number of series",ylab="Length",ylim=c(0,max(sl)))
if (length(sl.u)>0){
# Plot under threshold
polygon(c(1:length(sl.u),length(sl.u),n,n,1),c(sl.u,min(sl.a)*c(1,1),0,0),col="grey",border="black")
# Plot over threshold
polygon(c((length(sl.u)+1):n,n,(length(sl.u)+1)),c(sl.a,max(sl.u)*c(1,1)),col="deepskyblue",border="black")
mtext(c(paste0(round(100*sum(!idx)/n,2),'%'),paste0(round(100*sum(idx)/n,2),'%')),side=4,line=0.2,at=c(max(sl.u)/2,((max(sl)-max(sl.u))/2+max(sl.u))))
} else {
polygon(c(1:n,n,1),c(sl,0,0),col="deepskyblue",border="black")
}
lines(c(1,n),c(t,t),col="black",lwd=1,lty=1)
}
library(TStools)
x <- abs(matrix(cumsum(rnorm(5400,0,1)),36,150))
x[1:20,1:50] <- 0
nzlength(x,30,outplot=TRUE)
nzlength(data,30,outplot=TRUE)
nzlength(data,5,outplot=TRUE)
library(TStools)
nzlength(data,5,outplot=TRUE)
nzlength(data,0,outplot=TRUE)
nzlength(data,30,outplot=TRUE)
nzlength(data,29,outplot=TRUE)
nzlength(data,10,outplot=TRUE)
nzlength(data,1,outplot=TRUE)
nzlength(data,5,outplot=TRUE)
library(TStools)
library(TStools)
